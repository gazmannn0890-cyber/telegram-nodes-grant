/* ДОБАВЬ В КОНЕЦ ФАЙЛА style.css */

/* === СИСТЕМА КАСТОМНЫХ ФОНОВ === */
.background-selector {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1000;
}

.bg-preview {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    cursor: pointer;
    margin-bottom: 10px;
    border: 3px solid transparent;
    transition: all 0.3s ease;
    overflow: hidden;
    position: relative;
}

.bg-preview:hover {
    transform: scale(1.1);
    border-color: var(--tg-blue);
}

.bg-preview.active {
    border-color: var(--tg-blue);
    box-shadow: 0 0 0 3px var(--tg-blue), 0 0 20px rgba(0, 136, 204, 0.5);
}

/* Стандартные фоны */
.bg-default {
    background: linear-gradient(135deg, var(--tg-bg), var(--tg-bg-secondary));
}

.bg-gradient-1 {
    background: linear-gradient(135deg, #0088cc, #6a11cb, #2575fc);
}

.bg-gradient-2 {
    background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
}

.bg-gradient-3 {
    background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1);
}

.bg-pattern-1 {
    background: 
        radial-gradient(circle at 20% 80%, rgba(64, 183, 232, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(175, 82, 222, 0.15) 0%, transparent 50%),
        var(--tg-bg);
}

.bg-pattern-2 {
    background: 
        linear-gradient(45deg, transparent 48%, rgba(52, 199, 89, 0.1) 50%, transparent 52%),
        linear-gradient(-45deg, transparent 48%, rgba(255, 59, 48, 0.1) 50%, transparent 52%),
        var(--tg-bg);
    background-size: 40px 40px;
}

/* Анимированные фоны */
.bg-animated {
    position: relative;
    overflow: hidden;
}

.bg-animated::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
        45deg,
        transparent 30%,
        rgba(64, 183, 232, 0.1) 50%,
        transparent 70%
    );
    animation: bg-shine 8s infinite linear;
}

@keyframes bg-shine {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Контейнер с поддержкой фонов */
.container.with-bg {
    background: transparent;
    position: relative;
    overflow: hidden;
}

.container-bg-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    opacity: 0.1;
    transition: opacity 0.5s ease;
}

.container.with-bg .side-menu,
.container.with-bg .main-content,
.container.with-bg .node-admin-panel {
    background: rgba(var(--tg-card-rgb), 0.9);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(var(--tg-border-rgb), 0.3);
}

/* Переменные для rgba цветов */
.day-theme {
    --tg-card-rgb: 255, 255, 255;
    --tg-border-rgb: 229, 229, 234;
}

.night-theme {
    --tg-card-rgb: 28, 28, 30;
    --tg-border-rgb: 44, 44, 46;
}

/* === АНИМИРОВАННЫЙ ДРАКОН === */
.dragon-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -2;
    pointer-events: none;
    overflow: hidden;
}

.fire-dragon {
    position: absolute;
    width: 180px;
    height: 120px;
    background: linear-gradient(90deg, 
        #ff6b00 0%, 
        #ff9500 20%, 
        #ffcc00 40%, 
        #ff9500 60%, 
        #ff6b00 80%, 
        #ff3b30 100%
    );
    border-radius: 60% 40% 40% 60%;
    animation: fly-around 25s infinite linear;
    filter: drop-shadow(0 0 20px rgba(255, 107, 0, 0.7));
    opacity: 0.7;
}

.fire-dragon::before {
    content: '';
    position: absolute;
    top: 30%;
    left: -20px;
    width: 40px;
    height: 40px;
    background: radial-gradient(circle, #ffcc00 0%, #ff6b00 50%, transparent 70%);
    border-radius: 50%;
    animation: fire-pulse 1.5s infinite alternate;
}

.fire-dragon::after {
    content: '';
    position: absolute;
    top: 60%;
    right: -30px;
    width: 60px;
    height: 30px;
    background: linear-gradient(90deg, 
        transparent 0%,
        #ff3b30 30%,
        #ff9500 70%,
        transparent 100%
    );
    border-radius: 0 50% 50% 0;
    animation: tail-wag 0.5s infinite alternate;
}

.dragon-trail {
    position: absolute;
    width: 300px;
    height: 20px;
    background: radial-gradient(ellipse at center, 
        rgba(255, 107, 0, 0.4) 0%,
        rgba(255, 107, 0, 0.2) 40%,
        transparent 70%
    );
    animation: trail-fade 2s infinite linear;
}

@keyframes fly-around {
    0% {
        transform: translate(-200px, 100px) rotate(0deg);
    }
    25% {
        transform: translate(300px, 300px) rotate(90deg);
    }
    50% {
        transform: translate(800px, 100px) rotate(180deg);
    }
    75% {
        transform: translate(400px, -100px) rotate(270deg);
    }
    100% {
        transform: translate(-200px, 100px) rotate(360deg);
    }
}

@keyframes fire-pulse {
    0% { transform: scale(1); opacity: 0.8; }
    100% { transform: scale(1.3); opacity: 1; }
}

@keyframes tail-wag {
    0% { transform: rotate(-10deg); }
    100% { transform: rotate(10deg); }
}

@keyframes trail-fade {
    0% { opacity: 0; transform: translateX(0); }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { opacity: 0; transform: translateX(100px); }
}

/* Интерактивность с драконом */
.node-avatar:hover ~ .dragon-container .fire-dragon {
    animation-duration: 15s;
    filter: drop-shadow(0 0 30px rgba(255, 107, 0, 0.9));
}

/* === ДОПОЛНИТЕЛЬНЫЕ ФОНЫ === */
/* Космическая тема */
.bg-space {
    background: 
        radial-gradient(ellipse at 20% 30%, rgba(64, 183, 232, 0.3) 0%, transparent 40%),
        radial-gradient(ellipse at 80% 70%, rgba(175, 82, 222, 0.3) 0%, transparent 40%),
        linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a1a 100%);
}

.bg-space::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
        radial-gradient(white 1px, transparent 1px),
        radial-gradient(white 1px, transparent 1px);
    background-size: 50px 50px, 80px 80px;
    background-position: 0 0, 25px 25px;
    opacity: 0.3;
    animation: stars-move 100s infinite linear;
}

@keyframes stars-move {
    0% { transform: translateY(0); }
    100% { transform: translateY(50px); }
}

/* Акварельная тема */
.bg-watercolor {
    background: 
        radial-gradient(circle at 10% 20%, rgba(64, 183, 232, 0.4) 0%, transparent 40%),
        radial-gradient(circle at 90% 80%, rgba(175, 82, 222, 0.4) 0%, transparent 40%),
        radial-gradient(circle at 50% 50%, rgba(52, 199, 89, 0.3) 0%, transparent 50%),
        linear-gradient(135deg, #ffffff 0%, #f0f8ff 100%);
}

/* Неоновая тема */
.bg-neon {
    background: 
        linear-gradient(135deg, 
            #0f0f1a 0%, 
            #1a0f2a 25%, 
            #0f1a2a 50%, 
            #1a2a0f 75%, 
            #0f0f1a 100%
        );
    position: relative;
}

.bg-neon::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: 
        linear-gradient(45deg, 
            transparent 45%, 
            rgba(0, 136, 204, 0.1) 50%, 
            transparent 55%
        ),
        linear-gradient(-45deg, 
            transparent 45%, 
            rgba(175, 82, 222, 0.1) 50%, 
            transparent 55%
        );
    background-size: 60px 60px;
    animation: neon-grid 20s infinite linear;
}

@keyframes neon-grid {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* === АДАПТИВНЫЕ ЭЛЕМЕНТЫ ДЛЯ ВСЕХ === */
/* Для детей - более мягкие формы */
.mode-kids .container,
.mode-kids .node-avatar,
.mode-kids .chat-item,
.mode-kids .switch-item {
    border-radius: 20px !important;
}

.mode-kids .node-avatar {
    border-radius: 16px !important;
}

/* Для профессионалов - более строгий стиль */
.mode-pro .container {
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
}

.mode-pro .side-menu,
.mode-pro .main-content {
    background: rgba(var(--tg-card-rgb), 0.95);
}

/* Универсальные улучшения */
.chat-item {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.node-avatar {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.node-avatar:hover {
    transform: scale(1.1);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

/* Анимация появления элементов */
@keyframes slide-up {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.chat-item,
.node-item,
.switch-item {
    animation: slide-up 0.5s ease backwards;
}

.chat-item:nth-child(1) { animation-delay: 0.1s; }
.chat-item:nth-child(2) { animation-delay: 0.2s; }
.chat-item:nth-child(3) { animation-delay: 0.3s; }
.chat-item:nth-child(4) { animation-delay: 0.4s; }
.node-item:nth-child(1) { animation-delay: 0.1s; }
.node-item:nth-child(2) { animation-delay: 0.2s; }
.node-item:nth-child(3) { animation-delay: 0.3s; }
